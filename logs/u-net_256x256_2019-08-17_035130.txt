Checking sequences...
[Warning: Hash file not found. Comparing converted and specified sequences] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('CNN_Segmentation_Train_and_Evaluate', '/home/tyson/Dropbox/Academic/4th Year/ELEN4012/Raiden/matlab/CNN_Segmentation_Train_and_Evaluate.m', 115)" style="font-weight:bold">CNN_Segmentation_Train_and_Evaluate</a> (<a href="matlab: opentoline('/home/tyson/Dropbox/Academic/4th Year/ELEN4012/Raiden/matlab/CNN_Segmentation_Train_and_Evaluate.m',115,0)">line 115</a>)] 
[Warning: Source and conversion folders match. Data will not converted. Enable forceConvert to override] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('CNN_Segmentation_Train_and_Evaluate', '/home/tyson/Dropbox/Academic/4th Year/ELEN4012/Raiden/matlab/CNN_Segmentation_Train_and_Evaluate.m', 126)" style="font-weight:bold">CNN_Segmentation_Train_and_Evaluate</a> (<a href="matlab: opentoline('/home/tyson/Dropbox/Academic/4th Year/ELEN4012/Raiden/matlab/CNN_Segmentation_Train_and_Evaluate.m',126,0)">line 126</a>)] 
Loaded metadata from cache...
Partitioning test and training Data...
Starting parallel pool (parpool) using the 'local' profile ...
Connected to the parallel pool (number of workers: 16).
Counting per-label pixel distribution...
      <strong>Name</strong>      <strong>PixelCount</strong>    <strong>ImagePixelCount</strong>
    <strong>________</strong>    <strong>__________</strong>    <strong>_______________</strong>
    'leader'    5.1264e+06      1.4786e+09   
    'stroke'    2.0006e+06      3.6110e+07   
    'sky'       9.9800e+08      1.8608e+09   
    'cloud'     6.5041e+08      1.2269e+09   
    'ground'    1.9941e+08      1.8612e+09   
    'other'     6.2724e+06      7.7188e+08   
Datastores cached
Splitting training/validation data...
Training images: 22720 
Validation images: 5680 
Testing images: 5002 
Data cached
Setting up Network...
Network created
Setting up Training...
options = 
  <a href="matlab:helpPopup nnet.cnn.TrainingOptionsSGDM" style="font-weight:bold">TrainingOptionsSGDM</a> with properties:

                     Momentum: 9.0000e-01
             InitialLearnRate: 1.0000e-02
    LearnRateScheduleSettings: [1×1 struct]
             L2Regularization: 5.0000e-03
      GradientThresholdMethod: 'l2norm'
            GradientThreshold: 10
                    MaxEpochs: 50
                MiniBatchSize: 32
                      Verbose: 1
             VerboseFrequency: 50
               ValidationData: [1×1 pixelLabelImageDatastore]
          ValidationFrequency: 10
           ValidationPatience: 8
                      Shuffle: 'every-epoch'
               CheckpointPath: '/home/tyson/Raiden/networks/checkpoints'
         ExecutionEnvironment: 'auto'
                   WorkerLoad: []
                    OutputFcn: []
                        Plots: 'training-progress'
               SequenceLength: 'longest'
         SequencePaddingValue: 0
         DispatchInBackground: 0
Beginning training...
Training on single GPU.
Initializing input data normalization.
|======================================================================================================================|
|  Epoch  |  Iteration  |  Time Elapsed  |  Mini-batch  |  Validation  |  Mini-batch  |  Validation  |  Base Learning  |
|         |             |   (hh:mm:ss)   |   Accuracy   |   Accuracy   |     Loss     |     Loss     |      Rate       |
|======================================================================================================================|
[Warning: GPU is low on memory, which can slow performance due to additional data transfers with main memory. Try reducing the
'MiniBatchSize' training option. This warning will not appear again unless you run the command:
<a href="matlab:warning('on','nnet_cnn:warning:GPULowOnMemory')">warning('on','nnet_cnn:warning:GPULowOnMemory')</a>.] 
{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trainNetwork', '/usr/local/MATLAB/R2019a/toolbox/nnet/cnn/trainNetwork.m', 165)" style="font-weight:bold">trainNetwork</a> (<a href="matlab: opentoline('/usr/local/MATLAB/R2019a/toolbox/nnet/cnn/trainNetwork.m',165,0)">line 165</a>)
GPU out of memory. Try reducing 'MiniBatchSize' using the trainingOptions function.
Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('CNN_Segmentation_Train_and_Evaluate', '/home/tyson/Dropbox/Academic/4th Year/ELEN4012/Raiden/matlab/CNN_Segmentation_Train_and_Evaluate.m', 583)" style="font-weight:bold">CNN_Segmentation_Train_and_Evaluate</a> (<a href="matlab: opentoline('/home/tyson/Dropbox/Academic/4th Year/ELEN4012/Raiden/matlab/CNN_Segmentation_Train_and_Evaluate.m',583,0)">line 583</a>)
    networkStatus.trainingTime = toc;
Caused by:
    Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('nnet.internal.cnngpu.convolveBackwardData2D')" style="font-weight:bold">nnet.internal.cnngpu.convolveBackwardData2D</a>
    Out of memory on device. To view more detail about available memory on the GPU, use 'gpuDevice()'. If the problem
    persists, reset the GPU by calling 'gpuDevice(1)'.} 
CNN_Segmentation_Train_and_Evaluate
network =
    'u-net'
forceConvert =
     0
preProcess =
     0
partitionData =
     1
resplitValidation =
     1
useCachedNet =
     0
doTraining =
     1
recoverCheckpoint =
     0
archiveNet =
     1
saveImages =
     1
sendNotification =
     1
evaluateNet =
     1
percentage =
     1
imageSize =
   256   256
logFileFull = 
    "/home/tyson/Raiden/logs/u-net_256x256_2019-08-17_035510.txt"
